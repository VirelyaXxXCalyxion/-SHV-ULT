---
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const relics = await getCollection('relics');
  return relics.map((relic) => ({
    params: { slug: relic.slug },
    props: { relic }
  }));
}

const { relic } = Astro.props as { relic: CollectionEntry<'relics'> };
const { title } = relic.data;
const { Content } = await relic.render();
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} â€” Ashvault</title>
  </head>
  <body style="background:black; color:white; font-family:serif; padding:2.5rem;">
    <div id="threshold">
      <p style="font-size:1rem; opacity:0.7; margin-bottom:1.5rem;">
        To access this relic, you must understand the cost of beauty.
      </p>
      <p style="font-size:1.25rem; margin-bottom:2rem;">
        Are you willing to pay what roses demand?
      </p>
      <button id="answer" style="background:#ff7a1a; color:black; border:none; padding:0.75rem 1.5rem; border-radius:0.5rem; font-size:1rem; font-weight:600; cursor:pointer;">
        I accept the cost.
      </button>
    </div>

    <div id="relic" style="display:none;">
      <h1 style="font-size:2rem; margin-bottom:1rem;">{title}</h1>
      <article style="font-size:1.1rem; line-height:1.8;">
        <Content />
      </article>
    </div>

    <script>
      const btn = document.getElementById('answer');
      const threshold = document.getElementById('threshold');
      const relicDiv = document.getElementById('relic');

      btn?.addEventListener('click', () => {
        if (threshold) threshold.style.display = 'none';
        if (relicDiv) relicDiv.style.display = 'block';
      });
    </script>
  </body>
</html>